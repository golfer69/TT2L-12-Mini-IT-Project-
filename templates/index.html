
{% extends 'base.html' %}

{% block content %}
  <div class="app">
    <div class="sidebar">
      <a class="btn" href="/createcommunity"> + Create community </a>
      {% for community in communities %}
        <a class="btn" href="{{ url_for('show_community', community_name=community.name) }}">{{community.name}}</a>
      {% endfor %}
    </div>
    <div class="posts-section">
      {% for post in posts %}
      <div class="posts">
        <a href="{{ url_for('show_community', community_name=post.community.name) }}" class="community-label"> 
          r/{{ post.community.name}}
        </a>
        <p>Votes: <span id="vote-count-{{ post.id }}">{{ post.votes }}</span></p>
        <a href="{{ url_for('show_post', post_id=post.id) }}">  
          <h3 >{{post.title}}</h3> 
          <!-- if got img show img else the desc -->
          {% if post.image_filename %} 
              <img src="{{ url_for('serve_files', filename=post.image_filename) }}">
            {% else %}
              <p>{{ post.content }}</p>
          {% endif %}
          
        </a>
        <div class="clear"></div>
        <button class="vote-btn" data-vote-type="upvote" type="button" data-post-id="{{ post.id }}" onclick="upvotePost(this)">Upvote</button>
        <button class="vote-btn" data-vote-type="downvote" type="button" data-post-id="{{ post.id }}" onclick="downvotePost(this)">Downvote</button>
      </div>
      <hr>
      {% endfor %}
    </div>
  </div>
{% endblock %}



